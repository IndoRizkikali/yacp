--- origsrc/xxHash-0.7.0/cmake_unofficial/CMakeLists.txt	2019-03-16 02:15:30.000000000 +0900
+++ src/xxHash-0.7.0/cmake_unofficial/CMakeLists.txt	2019-03-31 06:51:51.794175700 +0900
@@ -62,8 +62,8 @@ if (BUILD_SHARED_LIBS)
   target_compile_definitions(xxhash PUBLIC XXH_EXPORT)
 endif ()
 set_target_properties(xxhash PROPERTIES
-  SOVERSION "${XXHASH_VERSION_STRING}"
-  VERSION "${XXHASH_VERSION_STRING}")
+  SOVERSION "${XXHASH_LIB_SOVERSION}"
+  VERSION "${XXHASH_LIB_VERSION}")
 
 # xxhsum
 add_executable(xxhsum "${XXHASH_DIR}/xxhsum.c")
@@ -95,7 +95,7 @@ if(NOT XXHASH_BUNDLED_MODE)
   install(TARGETS xxhsum
     RUNTIME DESTINATION "${CMAKE_INSTALL_BINDIR}")
   install(TARGETS xxhash
-    LIBRARY DESTINATION "${CMAKE_INSTALL_LIBDIR}"
+    RUNTIME DESTINATION "${CMAKE_INSTALL_BINDIR}"
     ARCHIVE DESTINATION "${CMAKE_INSTALL_LIBDIR}")
   install(FILES "${XXHASH_DIR}/xxhash.h"
     DESTINATION "${CMAKE_INSTALL_INCLUDEDIR}")
@@ -106,3 +106,10 @@ if(NOT XXHASH_BUNDLED_MODE)
   install(FILES "${XXHASH_DIR}/xxhsum.1"
     DESTINATION "${CMAKE_INSTALL_MANDIR}/man1")
 endif(NOT XXHASH_BUNDLED_MODE)
+
+SET(prefix ${CMAKE_INSTALL_PREFIX})
+SET(exec_prefix ${CMAKE_INSTALL_PREFIX})
+SET(libdir ${CMAKE_INSTALL_PREFIX}/lib)
+SET(includedir ${CMAKE_INSTALL_PREFIX}/include)
+CONFIGURE_FILE(${CMAKE_SOURCE_DIR}/xxhash.pc.in ${CMAKE_BINARY_DIR}/xxhash.pc @ONLY)
+INSTALL(FILES ${CMAKE_BINARY_DIR}/xxhash.pc DESTINATION ${CMAKE_INSTALL_PREFIX}/lib/pkgconfig)
--- origsrc/xxHash-0.7.0/cmake_unofficial/xxhash.pc.in	1970-01-01 09:00:00.000000000 +0900
+++ src/xxHash-0.7.0/cmake_unofficial/xxhash.pc.in	2019-03-31 06:53:31.425874300 +0900
@@ -0,0 +1,10 @@
+prefix=@prefix@
+exec_prefix=@exec_prefix@
+libdir=@libdir@
+includedir=@includedir@
+
+Name: xxhash
+Description: Extremely fast hash algorithm
+Version: @XXHASH_VERSION_STRING@
+Libs: -L${libdir} -lxxhash
+Cflags: -I${includedir}
--- origsrc/xxHash-0.7.0/xxhsum.c	2019-03-16 02:15:30.000000000 +0900
+++ src/xxHash-0.7.0/xxhsum.c	2019-03-31 06:42:17.281413800 +0900
@@ -89,10 +89,10 @@
 #if (defined(__linux__) && (PLATFORM_POSIX_VERSION >= 1)) \
  || (PLATFORM_POSIX_VERSION >= 200112L) \
  || defined(__DJGPP__) \
- || defined(__MSYS__)
+ || defined(__MSYS__) || defined(__CYGWIN__)
 #  include <unistd.h>   /* isatty */
 #  define IS_CONSOLE(stdStream) isatty(fileno(stdStream))
-#elif defined(MSDOS) || defined(OS2) || defined(__CYGWIN__)
+#elif defined(MSDOS) || defined(OS2)
 #  include <io.h>       /* _isatty */
 #  define IS_CONSOLE(stdStream) _isatty(_fileno(stdStream))
 #elif defined(WIN32) || defined(_WIN32)
