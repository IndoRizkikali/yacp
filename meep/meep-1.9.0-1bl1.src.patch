--- origsrc/meep-1.9.0/libpympb/Makefile.am	2019-04-18 02:50:41.000000000 +0900
+++ src/meep-1.9.0/libpympb/Makefile.am	2019-05-01 18:22:31.019429200 +0900
@@ -10,5 +10,5 @@ pkginclude_HEADERS = pympb.hpp
 
 libpympb_la_SOURCES = pympb.cpp pympb.hpp
 libpympb_la_LIBADD = $(LIBMEEP)
-libpympb_la_LDFLAGS = -version-info @SHARED_VERSION_INFO@
+libpympb_la_LDFLAGS = -no-undefined -version-info @SHARED_VERSION_INFO@
 libpympb_la_CPPFLAGS = $(AM_CPPFLAGS)
--- origsrc/meep-1.9.0/python/Makefile.am	2019-04-18 02:50:41.000000000 +0900
+++ src/meep-1.9.0/python/Makefile.am	2019-05-01 19:31:43.744595600 +0900
@@ -92,8 +92,8 @@ AM_CPPFLAGS = -I$(top_srcdir)/src
 LIBMEEP = $(top_builddir)/src/libmeep.la
 
 _meep_la_SOURCES = meep-python.cxx
-_meep_la_LIBADD = $(LIBMEEP) $(PYTHON_LIBS)
-_meep_la_LDFLAGS = -module -version-info @SHARED_VERSION_INFO@
+_meep_la_LIBADD = $(LIBMEEP) $(PYTHON_LIBS) -lpython$(PYTHON_VERSION)
+_meep_la_LDFLAGS = -no-undefined -module -avoid-version # -version-info @SHARED_VERSION_INFO@
 _meep_la_CPPFLAGS = $(PYTHON_INCLUDES) $(AM_CPPFLAGS)
 
 pkgpyexec_LTLIBRARIES = _meep.la
@@ -110,8 +110,8 @@ if WITH_MPB
   pympb_PYTHON = mpb.py solver.py mpb_data.py
   pympb_LTLIBRARIES = _mpb.la
   _mpb_la_SOURCES = mpb-python.cxx
-  _mpb_la_LIBADD = $(PYTHON_LIBS) $(top_builddir)/libpympb/libpympb.la
-  _mpb_la_LDFLAGS = -module -version-info @SHARED_VERSION_INFO@
+  _mpb_la_LIBADD = $(PYTHON_LIBS) $(top_builddir)/libpympb/libpympb.la -lpython$(PYTHON_VERSION)
+  _mpb_la_LDFLAGS = -no-undefined -module -avoid-version # -version-info @SHARED_VERSION_INFO@
   _mpb_la_CPPFLAGS = $(PYTHON_INCLUDES) $(AM_CPPFLAGS)
 
 install-data-hook:
@@ -203,14 +203,14 @@ adjoint_PYTHON  = $(srcdir)/adjoint/__in
 # Q: Why is this not redundant since e.g. the HL_IFACE files should
 #    already be installed by virtue of being in pkgpython_PYTHON
 ######################################################################
-PY_PKG_FILES = $(INIT_PY) $(HL_IFACE) .libs/_meep.so
+PY_PKG_FILES = $(INIT_PY) $(HL_IFACE) # .libs/_meep.so
 
 meep: _meep.la $(MPB_LA) __init__.py $(HL_IFACE)
 	mkdir -p meep
 	cp $(PY_PKG_FILES) meep
 if WITH_MPB
 	mkdir -p meep/mpb
-	cp .libs/_mpb.so meep/mpb
+#	cp .libs/_mpb.so meep/mpb
 	cp $(MPB_PY_PATH) meep/mpb/__init__.py
 	cp $(srcdir)/solver.py $(srcdir)/mpb_data.py meep/mpb
 endif
--- origsrc/meep-1.9.0/src/Makefile.am	2019-04-18 02:50:41.000000000 +0900
+++ src/meep-1.9.0/src/Makefile.am	2019-05-01 18:24:00.900801800 +0900
@@ -19,7 +19,7 @@ sources.cpp step.cpp step_db.cpp stress.
 susceptibility.cpp time.cpp update_eh.cpp mpb.cpp update_pols.cpp 	\
 vec.cpp step_generic.cpp meepgeom.cpp GDSIIgeom.cpp $(HDRS) $(BUILT_SOURCES)
 
-libmeep_la_LDFLAGS = -version-info @SHARED_VERSION_INFO@
+libmeep_la_LDFLAGS = -no-undefined -version-info @SHARED_VERSION_INFO@
 
 PRELUDE = "/* This file was automatically generated --- DO NOT EDIT */"
 
@@ -27,7 +27,7 @@ noinst_PROGRAMS = sphere_quad
 sphere_quad_SOURCES = sphere-quad.cpp
 SPHERE_QUAD = $(top_builddir)/src/sphere_quad
 sphere-quad.h:
-	make sphere_quad
+	make sphere_quad$(EXEEXT)
 	(echo $(PRELUDE); echo; $(SPHERE_QUAD)) > $@
 
 step_generic_stride1.cpp: step_generic.cpp
